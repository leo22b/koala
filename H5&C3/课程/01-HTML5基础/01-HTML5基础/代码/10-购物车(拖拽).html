<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			*{
				margin: 0;
				padding: 0;
			}
			.books{
				width: 848px;
				margin: 30px auto;
				list-style: none;
			}
			.books li{
				border: 1px solid gray;
				width: 200px;
				height: 320px;
				float: left;
				margin: 5px;
			}
			.books li img{
				width: 200px;
				height: 260px;
				border-bottom: 1px solid gray;
			}
			.books li p{
				line-height: 30px;
				text-align: center;
			}
			
			
			.shops{
				width: 250px;
				border: 1px solid gray;
				text-align: center;
				/* 固定定位*/
				position: fixed;
				top: 0;
				left: 0;
			}
			.shops h3{
				height: 50px;
				line-height: 50px;
				background: gray;
			}
			.shops ul{
				list-style: none;
				display: none;
			}
			.shops li{
				height: 100px;
				line-height: 100px;
				border-bottom: 1px solid white;
				background: red;
			}
			.shops li i{
				width: 20px;
				float: left;
			}
			.shops li p{
				float: left;
				width: 150px;
			}
			.shops li img{
				float: right;
				width: 80px;
				height: 100px;
			}
		</style>
		<script type="text/javascript">
			window.onload = function(){
				var oBooks = document.querySelector(".books");
				var aLi = oBooks.querySelectorAll('li');
				var oShops = document.querySelector(".shops");
				var oShopUl = oShops.querySelector('ul');
				
				oShops.onmouseover = function(){
					oShopUl.style.display = 'block';
				}
				oShops.onmouseout = function(){
					oShopUl.style.display = 'none';
				}
				
				
				// 添加拖拽
				for(var i=0; i<aLi.length; i++){
					aLi[i].draggable = 'true';
					aLi[i].index = i;
					
					aLi[i].ondragstart = function(ev){
						ev = ev || window.event;
						ev.dataTransfer.setData('index', this.index.toString());
						
						// 默认图片是有拖拽的，在这里改变拖拽的样式即可
						ev.dataTransfer.setDragImage(this, ev.offsetX, ev.offsetY);
					}
				}
				
				
				// 目标元素
				oShops.ondragover = function(){
					return false;
				}
				
				oShops.ondrop = function(ev){
					ev = ev || window.event;
					var index = parseInt(ev.dataTransfer.getData('index'));
					// console.log( index );
					
					// 获取到对应的元素
					var content = aLi[index].querySelector('p').innerHTML;
					var imgSrc = aLi[index].querySelector('img').src;
					
					var oLi = document.createElement('li');
					oShopUl.appendChild(oLi);
					
					var oI = document.createElement('i');
					oI.innerHTML = oShopUl.querySelectorAll('li').length;
					oLi.appendChild(oI);
					
					var oP = document.createElement('p');
					oP.innerHTML = content;
					oLi.appendChild(oP);
					
					var oImg = document.createElement('img');
					oImg.src = imgSrc;
					oLi.appendChild(oImg);
				}
			}
		</script>
	</head>
	
	<body>
		<div class="shops">
			<h3>购物车</h3>
			<ul>
				<!--<li>
					<i>1</i>
					<p>JavaScript语言精粹</p>
					<img src="images/img1.jpg" />
				</li>
				<li>
					<i>1</i>
					<p>JavaScript语言精粹</p>
					<img src="images/img1.jpg" />
				</li>
				<li>
					<i>1</i>
					<p>JavaScript语言精粹</p>
					<img src="images/img1.jpg" />
				</li>-->
			</ul>
		</div>
		
		<ul class="books">
			<li>
				<img src="images/img1.jpg" />
				<p>JavaScript语言精粹</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img2.jpg" />
				<p>JavaScript权威指南</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img3.jpg" />
				<p>精通JavaScript</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img4.jpg" />
				<p>JavaScript编程技术</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img2.jpg" />
				<p>JavaScript权威指南</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img2.jpg" />
				<p>JavaScript权威指南</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img3.jpg" />
				<p>精通JavaScript</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img4.jpg" />
				<p>JavaScript编程技术</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img3.jpg" />
				<p>精通JavaScript</p>
				<p>￥99</p>
			</li>
			
			<li>
				<img src="images/img4.jpg" />
				<p>JavaScript编程技术</p>
				<p>￥99</p>
			</li>
		</ul>
	</body>
</html>
